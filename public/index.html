<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>dcpynet - Instagram</title>
<style>
:root {
  --bg: #000;
  --text: #fff;
  --subtext: #bfbfbf;
  --green: #00c46b;
  --card-bg: #0d0d0d;
  --border: #1a1a1a;
  --radius: 14px;
  font-family: 'Inter', sans-serif;
}

body {
  margin:0;
  background: var(--bg);
  color: var(--text);
}

header {
  text-align:center;
  padding:50px 20px;
  font-size:3rem;
  font-weight:700;
}
header span { color: var(--green); }

.container { max-width:600px; margin:auto; padding:20px; }
label { display:block; margin-top:20px; font-weight:600; }
select, input { width:100%; padding:10px; margin-top:5px; border-radius:8px; border:none; font-size:1rem; }
button { margin-top:20px; padding:15px; width:100%; border:none; border-radius:8px; background:var(--green); color:#000; font-weight:700; cursor:pointer; font-size:1rem; }

#total { margin-top:10px; font-weight:600; color: var(--green); }
</style>
</head>
<body>

<header><span>dcpynet</span> Instagram</header>
<div class="container">
  <label>Category</label>
  <select id="category">
    <option value="followers">Followers</option>
    <option value="likes">Likes</option>
    <option value="comments">Comments</option>
  </select>

  <label>Quality</label>
  <select id="quality"></select>

  <label>Refill</label>
  <select id="refill"></select>

  <label>Quantity</label>
  <input type="number" id="quantity" min="1" value="100">

  <label>Link</label>
  <input type="text" id="link" placeholder="Paste post/profile link">

  <div id="total">Total: $0.00</div>
  <button id="orderBtn">Place Order</button>
</div>

<script>
// === SERVICE DATA ===
const services = {
  followers: [
    {id:8950, name:"HQ Profiles", refill:"No Refill", price:1.21},
    {id:8951, name:"HQ Profiles", refill:"No Refill", price:1.22},
    {id:8959, name:"Real & Old +7-15 Posts", refill:"No Refill", price:1.33},
    {id:8960, name:"Real & Old +7-15 Posts", refill:"30 Days", price:1.55},
    {id:8933, name:"HQ Accounts", refill:"No Refill", price:1.31},
    {id:8934, name:"HQ Accounts", refill:"No Refill", price:1.32}
  ],
  likes: [
    {id:8923, name:"HQ Profiles", refill:"No Refill", price:1.077},
    {id:8917, name:"Profile Photos", refill:"No Refill", price:1.10}
  ],
  comments: [
    {id:8901, name:"Random", refill:"No Refill", price:1.45},
    {id:8904, name:"Custom", refill:"No Refill", price:1.52}
  ]
};

// === POPULATE QUALITY & REFILL DROPDOWNS ===
const categoryEl = document.getElementById('category');
const qualityEl = document.getElementById('quality');
const refillEl = document.getElementById('refill');
const quantityEl = document.getElementById('quantity');
const totalEl = document.getElementById('total');

function updateDropdowns() {
  const cat = categoryEl.value;
  const catServices = services[cat];
  // unique qualities
  const qualities = [...new Set(catServices.map(s=>s.name))];
  qualityEl.innerHTML = qualities.map(q=>`<option value="${q}">${q}</option>`).join('');
  updateRefill();
}

function updateRefill() {
  const cat = categoryEl.value;
  const qual = qualityEl.value;
  const catServices = services[cat].filter(s=>s.name===qual);
  const refills = [...new Set(catServices.map(s=>s.refill))];
  refillEl.innerHTML = refills.map(r=>`<option value="${r}">${r}</option>`).join('');
  updateTotal();
}

function getService() {
  const cat = categoryEl.value;
  const qual = qualityEl.value;
  const refill = refillEl.value;
  const catServices = services[cat].filter(s=>s.name===qual && s.refill===refill);
  return catServices[0]; // first match
}

function updateTotal() {
  const service = getService();
  const qty = parseInt(quantityEl.value)||0;
  const total = service ? (service.price * (qty/1000)).toFixed(2) : 0;
  totalEl.textContent = `Total: $${total}`;
}

categoryEl.addEventListener('change', ()=>{ updateDropdowns(); });
qualityEl.addEventListener('change', ()=>{ updateRefill(); });
refillEl.addEventListener('change', ()=>{ updateTotal(); });
quantityEl.addEventListener('input', ()=>{ updateTotal(); });

updateDropdowns();

// === PLACE ORDER ===
document.getElementById('orderBtn').addEventListener('click', async ()=>{
  const service = getService();
  const link = document.getElementById('link').value;
  const quantity = parseInt(quantityEl.value);

  if(!link || !quantity || !service) return alert('Missing info');

  const res = await fetch('/api/order', {
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body: JSON.stringify({service: service.id, link, quantity})
  });

  const data = await res.json();
  if(data.error) alert(`Error: ${data.error}`);
  else alert('Order placed successfully!');
});
</script>
</body>
</html>
